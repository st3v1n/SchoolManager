<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Question Editor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .question-item {
      transition: all 0.3s ease;
      height: 40px;
      overflow: hidden;
    }
    
    .question-item.active, .question-item.hovered {
      height: 100px;
    }
    
    .option-enter {
      animation: optionEnter 0.3s ease-out;
    }
    
    @keyframes optionEnter {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .scrollbar-thin::-webkit-scrollbar {
      width: 4px;
    }
    
    .scrollbar-thin::-webkit-scrollbar-thumb {
      background-color: #cbd5e0;
      border-radius: 2px;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-4">
  <div class="max-w-6xl mx-auto">
    <div class="bg-white rounded-xl shadow-md overflow-hidden">
      <div class="p-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">Advanced Question Editor</h1>
        
        <div class="flex flex-col lg:flex-row gap-6">
          <!-- Questions List - Compact View -->
          <div class="w-full lg:w-1/5">
            <div id="questions-list" class="space-y-2 max-h-[70vh] overflow-y-auto pr-2 scrollbar-thin">
              <!-- Questions will be inserted here by JavaScript -->
            </div>
            <button id="add-question-btn" class="w-full mt-4 p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm">
              + Add Question
            </button>
          </div>
          
          <!-- Editor Area -->
          <div class="w-full lg:w-4/5">
            <div id="editor-container">
              <div class="mb-6">
                <label class="block text-lg font-medium text-gray-700 mb-2">Question <span id="question-number">1</span></label>
                <textarea 
                  id="question-text" 
                  placeholder="Enter your question here..." 
                  class="w-full p-4 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 text-lg min-h-[120px]"
                ></textarea>
              </div>
              
              <div class="space-y-4">
                <label class="block text-lg font-medium text-gray-700 mb-2">Options</label>
                <div id="options-container" class="space-y-3">
                  <!-- Options will be inserted here by JavaScript -->
                </div>
                
                <button id="add-option-btn" class="mt-4 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                  + Add Another Option
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // State management
      let questions = [];
      let currentQuestionIndex = 0;
      
      // DOM elements
      const questionsList = document.getElementById('questions-list');
      const questionText = document.getElementById('question-text');
      const optionsContainer = document.getElementById('options-container');
      const questionNumber = document.getElementById('question-number');
      const addQuestionBtn = document.getElementById('add-question-btn');
      const addOptionBtn = document.getElementById('add-option-btn');
      
      // Initialize with first question
      addNewQuestion();
      
      // Event listeners
      addQuestionBtn.addEventListener('click', addNewQuestion);
      addOptionBtn.addEventListener('click', addNewOption);
      questionText.addEventListener('input', updateCurrentQuestionText);
      
      // Functions
      function addNewQuestion() {
        const newQuestion = {
          id: Date.now(),
          text: '',
          options: [
            { id: Date.now() + 1, text: '', isCorrect: false },
            { id: Date.now() + 2, text: '', isCorrect: false }
          ]
        };
        
        questions.push(newQuestion);
        renderQuestionsList();
        showQuestion(questions.length - 1);
      }
      
      function addNewOption() {
        if (questions.length === 0) return;
        
        const newOption = {
          id: Date.now(),
          text: '',
          isCorrect: false
        };
        
        questions[currentQuestionIndex].options.push(newOption);
        renderOptions();
      }
      
      function removeOption(optionId) {
        if (questions.length === 0) return;
        if (questions[currentQuestionIndex].options.length <= 2) return;
        
        questions[currentQuestionIndex].options = questions[currentQuestionIndex].options.filter(
          option => option.id !== optionId
        );
        
        renderOptions();
      }
      
      function updateCurrentQuestionText() {
        if (questions.length === 0) return;
        questions[currentQuestionIndex].text = questionText.value;
        renderQuestionsList();
      }
      
      function updateOptionText(optionId, text) {
        if (questions.length === 0) return;
        
        const option = questions[currentQuestionIndex].options.find(
          opt => opt.id === optionId
        );
        
        if (option) {
          option.text = text;
        }
      }
      
      function setCorrectOption(optionId) {
        if (questions.length === 0) return;
        
        questions[currentQuestionIndex].options.forEach(option => {
          option.isCorrect = option.id === optionId;
        });
        
        renderOptions();
        renderQuestionsList();
      }
      
      function showQuestion(index) {
        if (index < 0 || index >= questions.length) return;
        
        currentQuestionIndex = index;
        questionNumber.textContent = index + 1;
        
        // Update question text
        questionText.value = questions[index].text;
        
        // Update options
        renderOptions();
        
        // Update active state in question list
        const questionItems = questionsList.querySelectorAll('.question-item');
        questionItems.forEach((item, i) => {
          if (i === index) {
            item.classList.add('active');
            item.classList.remove('hovered');
          } else {
            item.classList.remove('active');
          }
        });
      }
      
      function renderQuestionsList() {
        questionsList.innerHTML = '';
        
        questions.forEach((question, index) => {
          const questionItem = document.createElement('div');
          questionItem.className = `question-item p-2 rounded-lg border cursor-pointer transition-all ${index === currentQuestionIndex ? 'active bg-blue-50 border-blue-200' : 'bg-gray-50 border-gray-200 hover:hovered hover:bg-gray-100'}`;
          
          questionItem.innerHTML = `
            <div class="flex justify-between items-start">
              <div class="flex-1 min-w-0">
                <div class="font-medium truncate text-sm">
                  ${question.text || `Question ${index + 1}`}
                </div>
                <div class="question-details mt-1 text-xs text-gray-500">
                  <div>Options: ${question.options.length}</div>
                  <div>${question.options.filter(o => o.isCorrect).length > 0 ? '✔ Correct answer set' : '⚠ No correct answer'}</div>
                </div>
              </div>
              ${questions.length > 1 ? `
                <button 
                  class="remove-question-btn text-red-500 hover:text-red-700 p-1 ml-2"
                  data-index="${index}"
                >
                  ×
                </button>
              ` : ''}
            </div>
          `;
          
          questionItem.addEventListener('click', () => showQuestion(index));
          
          // Add hover effects
          questionItem.addEventListener('mouseenter', () => {
            if (index !== currentQuestionIndex) {
              questionItem.classList.add('hovered');
            }
          });
          
          questionItem.addEventListener('mouseleave', () => {
            questionItem.classList.remove('hovered');
          });
          
          questionsList.appendChild(questionItem);
          
          // Add event listener for remove button if it exists
          const removeBtn = questionItem.querySelector('.remove-question-btn');
          if (removeBtn) {
            removeBtn.addEventListener('click', function(e) {
              e.stopPropagation();
              removeQuestion(parseInt(this.getAttribute('data-index')));
            });
          }
        });
      }
      
      function renderOptions() {
        if (questions.length === 0) return;
        
        optionsContainer.innerHTML = '';
        
        questions[currentQuestionIndex].options.forEach((option, index) => {
          const optionElement = document.createElement('div');
          optionElement.className = 'option-enter flex items-center gap-3';
          
          optionElement.innerHTML = `
            <input
              type="radio"
              name="correct-option-${questions[currentQuestionIndex].id}"
              ${option.isCorrect ? 'checked' : ''}
              class="h-5 w-5 text-blue-600 focus:ring-blue-500 cursor-pointer"
              onchange="setCorrectOption(${option.id})"
            >
            <input
              type="text"
              value="${option.text}"
              placeholder="Option ${index + 1}"
              class="flex-1 p-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200"
              oninput="updateOptionText(${option.id}, this.value)"
            >
            ${questions[currentQuestionIndex].options.length > 2 ? `
              <button 
                class="remove-option-btn text-red-500 hover:text-red-700 p-2"
                onclick="removeOption(${option.id})"
              >
                ×
              </button>
            ` : ''}
          `;
          
          optionsContainer.appendChild(optionElement);
        });
      }
      
      function removeQuestion(index) {
        if (questions.length <= 1) return;
        
        questions.splice(index, 1);
        
        if (currentQuestionIndex >= index) {
          currentQuestionIndex = Math.max(0, currentQuestionIndex - 1);
        }
        
        renderQuestionsList();
        showQuestion(currentQuestionIndex);
      }
      
      // Make functions available globally for inline event handlers
      window.setCorrectOption = setCorrectOption;
      window.updateOptionText = updateOptionText;
      window.removeOption = removeOption;
    });
  </script>
</body>
</html>